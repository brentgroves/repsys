# **[SQLDriverConnect Function](https://learn.microsoft.com/en-us/sql/odbc/reference/syntax/sqldriverconnect-function?view=sql-server-ver17)**

06/25/2024
Conformance
Version Introduced: ODBC 1.0 Standards Compliance: ODBC

Summary
SQLDriverConnect is an alternative to SQLConnect. It supports data sources that require more connection information than the three arguments in SQLConnect, dialog boxes to prompt the user for all connection information, and data sources that are not defined in the system information. For more information, see Connecting with SQLDriverConnect.

Syntax

```bash  
SQLRETURN SQLDriverConnect(  
     SQLHDBC         ConnectionHandle,  
     SQLHWND         WindowHandle,  
     SQLCHAR *InConnectionString,  
     SQLSMALLINT     StringLength1,  
     SQLCHAR*       OutConnectionString,  
     SQLSMALLINT     BufferLength,  
     SQLSMALLINT *   StringLength2Ptr,  
     SQLUSMALLINT    DriverCompletion);  
```

Arguments
ConnectionHandle
[Input] Connection handle.

WindowHandle
[Input] Window handle. The application can pass the handle of the parent window, if applicable, or a null pointer if either the window handle is not applicable or SQLDriverConnect will not present any dialog boxes.

InConnectionString
[Input] A full connection string (see the syntax in "Comments"), a partial connection string, or an empty string.

StringLength1
[Input] Length of *InConnectionString, in characters if the string is Unicode, or bytes if string is ANSI or DBCS.

OutConnectionString
[Output] Pointer to a buffer for the completed connection string. Upon successful connection to the target data source, this buffer contains the completed connection string. Applications should allocate at least 1,024 characters for this buffer.

If OutConnectionString is NULL, StringLength2Ptr will still return the total number of characters (excluding the null-termination character for character data) available to return in the buffer pointed to by OutConnectionString.

BufferLength
[Input] Length of the *OutConnectionString buffer, in characters.

StringLength2Ptr
[Output] Pointer to a buffer in which to return the total number of characters (excluding the null-termination character) available to return in *OutConnectionString. If the number of characters available to return is greater than or equal to BufferLength, the completed connection string in*OutConnectionString is truncated to BufferLength minus the length of a null-termination character.

DriverCompletion
[Input] Flag that indicates whether the Driver Manager or driver must prompt for more connection information:

SQL_DRIVER_PROMPT, SQL_DRIVER_COMPLETE, SQL_DRIVER_COMPLETE_REQUIRED, or SQL_DRIVER_NOPROMPT.

(For additional information, see "Comments.")

Returns
SQL_SUCCESS, SQL_SUCCESS_WITH_INFO, SQL_NO_DATA, SQL_ERROR, SQL_INVALID_HANDLE, or SQL_STILL_EXECUTING.

## Diagnostics

When SQLDriverConnect returns either SQL_ERROR or SQL_SUCCESS_WITH_INFO, an associated SQLSTATE value may be obtained by calling SQLGetDiagRec with an fHandleType of SQL_HANDLE_DBC and an hHandle of ConnectionHandle. The following table lists the SQLSTATE values commonly returned by SQLDriverConnect and explains each one in the context of this function; the notation "(DM)" precedes the descriptions of SQLSTATEs returned by the Driver Manager. The return code associated with each SQLSTATE value is SQL_ERROR, unless noted otherwise.

## Diagnostics

When SQLDriverConnect returns either SQL_ERROR or SQL_SUCCESS_WITH_INFO, an associated SQLSTATE value may be obtained by calling SQLGetDiagRec with an fHandleType of SQL_HANDLE_DBC and an hHandle of ConnectionHandle. The following table lists the SQLSTATE values commonly returned by SQLDriverConnect and explains each one in the context of this function; the notation "(DM)" precedes the descriptions of SQLSTATEs returned by the Driver Manager. The return code associated with each SQLSTATE value is SQL_ERROR, unless noted otherwise.

| SQLSTATE | Error                                                                                                | Description                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
|----------|------------------------------------------------------------------------------------------------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| 01000    | General warning                                                                                      | Driver-specific informational message. (Function returns SQL_SUCCESS_WITH_INFO.)                                                                                                                                                                                                                                                                                                                                                                                       |
| 01004    | String data, right truncated                                                                         | The buffer *OutConnectionString was not large enough to return the entire connection string, so the connection string was truncated. The length of the untruncated connection string is returned in*StringLength2Ptr. (Function returns SQL_SUCCESS_WITH_INFO.)                                                                                                                                                                                                       |
| 01S00    | Invalid connection string attribute                                                                  | An invalid attribute keyword was specified in the connection string (InConnectionString), but the driver was able to connect to the data source anyway. (Function returns SQL_SUCCESS_WITH_INFO.)                                                                                                                                                                                                                                                                      |
| 01S02    | Option value changed                                                                                 | The driver did not support the specified value pointed to by the ValuePtr argument in SQLSetConnectAttr and substituted a similar value. (Function returns SQL_SUCCESS_WITH_INFO.)                                                                                                                                                                                                                                                                                     |
| 01S08    | Error saving file DSN                                                                                | The string in *InConnectionString contained a FILEDSN keyword, but the .dsn file was not saved. (Function returns SQL_SUCCESS_WITH_INFO.)                                                                                                                                                                                                                                                                                                                              |
| 01S09    | Invalid keyword                                                                                      | (DM) The string in *InConnectionString contained a SAVEFILE keyword but not a DRIVER or a FILEDSN keyword. (Function returns SQL_SUCCESS_WITH_INFO.)                                                                                                                                                                                                                                                                                                                   |
| 08001    | Client unable to establish connection                                                                | The driver was unable to establish a connection with the data source.                                                                                                                                                                                                                                                                                                                                                                                                  |
| 08002    | Connection name in use                                                                               | (DM) The specified ConnectionHandle had already been used to establish a connection with a data source, and the connection was still open.                                                                                                                                                                                                                                                                                                                             |
| 08004    | Server rejected the connection                                                                       | The data source rejected the establishment of the connection for implementation-defined reasons.                                                                                                                                                                                                                                                                                                                                                                       |
| 08S01    | Communication link failure                                                                           | The communication link between the driver and the data source to which the driver was attempting to connect failed before the SQLDriverConnect function completed processing.                                                                                                                                                                                                                                                                                          |
| 28000    | Invalid authorization specification                                                                  | Either the user identifier or the authorization string, or both, as specified in the connection string (InConnectionString), violated restrictions defined by the data source.                                                                                                                                                                                                                                                                                         |
| HY000    | General error                                                                                        | An error occurred for which there was no specific SQLSTATE and for which no implementation-specific SQLSTATE was defined. The error message returned by SQLGetDiagRec in the *szMessageText buffer describes the error and its cause.                                                                                                                                                                                                                                  |
| HY000    | General error: Invalid file dsn                                                                      | (DM) The string in *InConnectionString contained a FILEDSN keyword, but the name of the .dsn file was not found.                                                                                                                                                                                                                                                                                                                                                       |
| HY000    | General error: Unable to create file buffer                                                          | (DM) The string in *InConnectionString contained a FILEDSN keyword, but the .dsn file was unreadable.                                                                                                                                                                                                                                                                                                                                                                  |
| HY001    | Memory allocation error                                                                              | The Driver Manager was unable to allocate memory required to support execution or completion of the SQLDriverConnect function.  The driver was unable to allocate memory required to support execution or completion of the function.                                                                                                                                                                                                                                  |
| HY008    | Operation canceled                                                                                   | Asynchronous processing was enabled for the ConnectionHandle. The function was called, and before it completed execution, the SQLCancelHandle function was called on the ConnectionHandle, and then the SQLDriverConnect function was called again on the ConnectionHandle.  Or, the SQLDriverConnect function was called, and before it completed execution, SQLCancelHandle was called on the ConnectionHandle from a different thread in a multithread application. |
| HY010    | Function sequence error                                                                              | (DM) Another asynchronously executing function (not SQLDriverConnect) was called for the ConnectionHandle and was still executing when the SQLDriverConnect function was called.                                                                                                                                                                                                                                                                                       |
| HY013    | Memory management error                                                                              | The SQLDriverConnect function call could not be processed because the underlying memory objects could not be accessed, possibly because of low memory conditions.                                                                                                                                                                                                                                                                                                      |
| HY090    | Invalid string or buffer length                                                                      | (DM) The value specified for argument StringLength1 was less than 0 and was not equal to SQL_NTS.  (DM) The value specified for argument BufferLength was less than 0.                                                                                                                                                                                                                                                                                                 |
| HY092    | Invalid attribute/option identifier                                                                  | (DM) The DriverCompletion argument was SQL_DRIVER_PROMPT, and the WindowHandle argument was a null pointer.                                                                                                                                                                                                                                                                                                                                                            |
| HY110    | Invalid driver completion                                                                            | (DM) The value specified for the argument DriverCompletion was not equal to SQL_DRIVER_PROMPT, SQL_DRIVER_COMPLETE, SQL_DRIVER_COMPLETE_REQUIRED, or SQL_DRIVER_NOPROMPT.  (DM) Connection pooling was enabled, and the value specified for the argument DriverCompletion was not equal to SQL_DRIVER_NOPROMPT.                                                                                                                                                        |
| HYC00    | Optional feature not implemented                                                                     | The driver does not support the version of ODBC behavior that the application requested.                                                                                                                                                                                                                                                                                                                                                                               |
| HYT00    | Timeout expired                                                                                      | The login timeout period expired before the connection to the data source completed. The timeout period is set through SQLSetConnectAttr, SQL_ATTR_LOGIN_TIMEOUT.                                                                                                                                                                                                                                                                                                      |
| HYT01    | Connection timeout expired                                                                           | The connection timeout period expired before the data source responded to the request. The connection timeout period is set through SQLSetConnectAttr, SQL_ATTR_CONNECTION_TIMEOUT.                                                                                                                                                                                                                                                                                    |
| IM001    | Driver does not support this function                                                                | (DM) The driver corresponding to the specified data source name does not support the function.                                                                                                                                                                                                                                                                                                                                                                         |
| IM002    | Data source not found and no default driver specified                                                | (DM) The data source name specified in the connection string (InConnectionString) was not found in the system information, and there was no default driver specification.  (DM) ODBC data source and default driver information could not be found in the system information.                                                                                                                                                                                          |
| IM003    | Specified driver could not be loaded                                                                 | (DM) The driver listed in the data source specification in the system information or specified by the DRIVER keyword was not found or could not be loaded for some other reason.                                                                                                                                                                                                                                                                                       |
| IM004    | Driver's SQLAllocHandle on SQL_HANDLE_ENV failed                                                     | (DM) During SQLDriverConnect, the Driver Manager called the driver's SQLAllocHandle function with an fHandleType of SQL_HANDLE_ENV and the driver returned an error.                                                                                                                                                                                                                                                                                                   |
| IM005    | Driver's SQLAllocHandle on SQL_HANDLE_DBC failed.                                                    | (DM) During SQLDriverConnect, the Driver Manager called the driver's SQLAllocHandle function with an fHandleType of SQL_HANDLE_DBC and the driver returned an error.                                                                                                                                                                                                                                                                                                   |
| IM006    | Driver's SQLSetConnectAttr failed                                                                    | (DM) During SQLDriverConnect, the Driver Manager called the driver's SQLSetConnectAttr function and the driver returned an error.                                                                                                                                                                                                                                                                                                                                      |
| IM007    | No data source or driver specified; dialog prohibited                                                | No data source name or driver was specified in the connection string, and DriverCompletion was SQL_DRIVER_NOPROMPT.                                                                                                                                                                                                                                                                                                                                                    |
| IM008    | Dialog failed                                                                                        | The driver attempted to display its login dialog box and failed.  WindowHandle was a null pointer, and DriverCompletion was not SQL_DRIVER_NO_PROMPT.                                                                                                                                                                                                                                                                                                                  |
| IM009    | Unable to load translation DLL                                                                       | The driver was unable to load the translation DLL that was specified for the data source or for the connection.                                                                                                                                                                                                                                                                                                                                                        |
| IM010    | Data source name too long                                                                            | (DM) The attribute value for the DSN keyword was longer than SQL_MAX_DSN_LENGTH characters.                                                                                                                                                                                                                                                                                                                                                                            |
| IM011    | Driver name too long                                                                                 | (DM) The attribute value for the DRIVER keyword was longer than 255 characters.                                                                                                                                                                                                                                                                                                                                                                                        |
| IM012    | DRIVER keyword syntax error                                                                          | (DM) The keyword-value pair for the DRIVER keyword contained a syntax error.  (DM) The string in *InConnectionString contained a FILEDSN keyword, but the .dsn file did not contain a DRIVER keyword or a DSN keyword.                                                                                                                                                                                                                                                 |
| IM014    | The specified DSN contains an architecture mismatch between the Driver and Application               | (DM) 32-bit application uses a DSN connecting to a 64-bit driver; or vice versa.                                                                                                                                                                                                                                                                                                                                                                                       |
| IM015    | Driver's SQLDriverConnect on SQL_HANDLE_DBC_INFO_HANDLE failed                                       | If a driver returns SQL_ERROR, the Driver Manager will return SQL_ERROR to the application and the connection will fail.  For more information about SQL_HANDLE_DBC_INFO_TOKEN, see Developing Connection-Pool Awareness in an ODBC Driver.                                                                                                                                                                                                                            |
| IM017    | Polling is disabled in asynchronous notification mode                                                | Whenever the notification model is used, polling is disabled.                                                                                                                                                                                                                                                                                                                                                                                                          |
| IM018    | SQLCompleteAsync has not been called to complete the previous asynchronous operation on this handle. | If the previous function call on the handle returns SQL_STILL_EXECUTING and if notification mode is enabled, SQLCompleteAsync must be called on the handle to do post-processing and complete the operation.                                                                                                                                                                                                                                                           |
| S1118    | Driver does not support asynchronous notification                                                    | When the driver does not support asynchronous notification, you cannot set SQL_ATTR_ASYNC_DBC_EVENT or SQL_ATTR_ASYNC_DBC_RETCODE_PTR.                                                                                                                                                                                                                                                                                                                                 |
